*我们这次做的是蛋白质（大分子）与药物（小分子）的对接*

首先要明确一点分子与分子对接，两者都会改变些结构，但是蛋白质的分子量远大于小分子药物，所以，我们这里默认的就是**半柔性对接**，受体结构不变，而小分子药物的“姿势”可能改变的。

| 对接类型  | 受体       | 配体      | 计算成本 |
| :---- | :------- | :------ | :--- |
| 刚性对接  | 锁（固定）    | 钥匙（固定）  | 低    |
| 半柔性对接 | 锁（固定）    | 钥匙（可弯曲） | 中等   |
| 柔性对接  | 锁（部分可变形） | 钥匙（可弯曲） | 高    |


![[3Q77-Thymol.png]]
<center>图：百里香酚对接在neutrophil elastase中</center>

## 需要的软件及其安装
需要下载比较多东西我们根据目的来一步步安装

| 顺序  | 下载项目              | 主要用途                                                      | 备注                   |
| --- | ----------------- | --------------------------------------------------------- | -------------------- |
| 1   | **LeDock**        | 执行分子对接计算                                                  | 图形界面友好，适合入门          |
| 2   | **PyMOL**         | 3D结构可视化、处理蛋白、生成图片                                         | 核心可视化工具              |
| 3   | **WSL**           | 在Windows中运行Linux环境                                        | 运行AutoDock Vina等工具需要 |
| 4   | **VS Code**       | 代码编辑器，为在WSL中运行软件指令提供界面<br>相当于Rstudio对于R，提供好看 简洁 方便的代码运行界面 | 提供舒适的终端操作环境          |
| 5   | **AutoDock Vina** | 另一款主流对接软件（指令操作）                                           | 作为备选或对比工具            |
| 6   | **MGLtools**      | 为Vina准备分子文件（加氢、电荷、格式转换）                                   | Vina的配套工具包           |
| 7   | **Open Babel**    | 通用分子文件格式转换与处理                                             | 非常实用的化学信息学工具         |

## Ledock做分子对接

**在这里我们先下载好Ledock、PyMol**

*我们来使用简单好用的Ledock做分子对接，顺便讲解分子结构的文件，以及需要的处理流程*
#### 1、获取目标受体配体的结构文件
- **受体（蛋白质）**：从 **PDB (Protein Data Bank)** 数据库获取。
    - 访问 [https://www.rcsb.org/](https://www.rcsb.org/)。
    - *PDB是一个常用的蛋白质结构数据库*
        ![[Pasted image 20251128230727.png|4px]]
    - 搜索目标蛋白，例如 “neutrophil elastase” (3Q77)。
        
    - 下载PDB格式文件 (`3q77.pdb`)。
        ![[Pasted image 20251128230851.png]]
- **配体（小分子）**：
    - 从 **PubChem** 数据库获取：搜索化合物（如 “Thymol”），下载其SDF格式的3D结构。 ![[Pasted image 20251128231150.png]]
- 这pdb文件和sdf文件都是结构文件，都可以在pymol中打开看结构![[Pasted image 20251128231926.png]]![[Pasted image 20251128231533.png]]
#### 2、去除受体文件中可能会出现的多余的水分子、金属离子等等“杂分子”
*原始PDB文件常包含水分子、多余的离子、辅因子等，这些会干扰对接，需要去除。*
#### 3、给受体配体加氢
*这两步骤ledock可以直接全部完成好*
首先，在桌面建一个文件夹，保存我们前面下载的结构文件
![[Pasted image 20251128232336.png]]
然后打开ledock
![[Pasted image 20251128232645.png]]
第一行输入刚刚下载的受体结构，然后第二行直接够出来一个去除杂粒子的“干净”的受体
点击左下角 ‘Add Hydrogen’加氢，然后就给受体加上氢离子了
然后同时他还给了下面框内的对接大概位置（超级智能！）并保存在第三行给的dock.in文件中
![[Pasted image 20251128235113.png]]
#### 4、给配体加氢，并把sdf格式文件转换成mol2格式文件
这里我们用pymol做下，Pymol主要是可视化用，但也可以处理很多操作
![[Pasted image 20251128233611.png]]
输入，下面就能实现加氢和保存mol2格式文件
``` pymol
#加氢
h_add 
#保存为mol2结构格式
save Thymol.mol2 
```
然后看我们的文件夹，多出来一些文件
包括前面ledock生成的干净且加氢的受体，大概得结合位点的dock.in文件，还有Pymol转换的配体的mol2文件。
![[Pasted image 20251128234042.png]]
#### 5、接着做分子对接，得到各种对接“姿势”及其结合能
第一行输入刚刚弄好的干净且加氢的受体文件，第二行输入ledock给的大概位置的dock.in文件，第三行输入配体文件。
点击start docking

![[Pasted image 20251128234319.png]]然后等计算好，就在文件夹内生成了一个文件，
陈列了配体的6种“姿势”
![[Pasted image 20251128234540.png]]
#### 文件头信息 (REMARK)

|字段|含义|解释与说明|
|---|---|---|
|**REMARK Docking time: 0.1 min**|**对接耗时**|本次分子对接计算耗时极短，仅为 **0.1 分钟** (6秒)。|
|**REMARK Cluster 1 of Poses: 11 Score: -3.36 kcal/mol**|**聚类与打分**|- **Cluster 1**: 第1号聚类 (最稳定构象簇)  <br>- **of Poses: 11**: 有11个构象属于此聚类，结果可信度高  <br>- **Score: -3.36 kcal/mol**: 结合自由能预测值，表明结合亲和力**中等偏弱**|
#### 原子坐标列说明 (ATOM Records)

以第一行为例：`ATOM 1 O LIG 0 39.524 -10.713 2.147`

|列号|列名|示例值|含义解释|
|---|---|---|---|
|**1**|**记录名**|`ATOM`|声明该行描述一个原子的坐标。对于配体，有时也用 `HETATM`。|
|**2**|**原子序号**|`1`|原子在该分子模型中的唯一编号，从1开始。|
|**3**|**原子名称**|`O`|使用元素符号表示，如 `O` (氧)、`C` (碳) 等。|
|**4**|**残基名称**|`LIG`|该原子所属分子的名称。`LIG` 是 **Ligand (配体)** 的通用缩写。|
|**5**|**残基序号**|`0`|将配体视作一个残基的编号。在蛋白质中，此为氨基酸序列号。|
|**6**|**X坐标**|`39.524`|原子在三维空间中的 **X 轴坐标**，单位通常为 **埃 (Å)**。|
|**7**|**Y坐标**|`-10.713`|原子在三维空间中的 **Y 轴坐标** (Å)。|
|**8**|**Z坐标**|`2.147`|原子在三维空间中的 **Z 轴坐标** (Å)。|
#### 在pymol里面看看我们的结果
先在Pymol里面打开我们的干净受体
然后我们把后缀dok的直接改成pdb，然后就可以放到Pymol里面了，
![[Pasted image 20251129000019.png]]
这个时候位置就能重叠到一块了，因为给出了6种“姿势”，一下子就显示出了6个配体
![[Pasted image 20251128235803.png]]

我们想个办法让他只有一个，我们记事本打开pdb文件（也就是原本的生成的dok文件），发现其实文件中6种姿势都是重复格式的，我们删除后面的就保留第一个就行了
![[Pasted image 20251129000219.png]]
在Pymol右边的A（action）上面点击 delete everything，删除刚刚的
![[Pasted image 20251129000337.png|300]]
然后重新导入受体，配体文件，然后我们分子对接及其可视化就做好了。
![[Pasted image 20251129000522.png]]